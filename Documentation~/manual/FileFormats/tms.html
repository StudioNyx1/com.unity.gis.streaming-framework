<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],   j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=   'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);  })(window,document,'script','dataLayer','GTM-5V25JL6');</script>
    <script type="text/javascript">thisPackageMetaData = { name: "com.unity.gis.streaming-framework", version: "1.0.0-preview.3", displayTitle:"Unity Geospatial Streaming 1.0.0-preview.3", lang: "en" };</script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    
  
    <title>Terrain Management System - Version 1.0 | Unity Geospatial Streaming | 1.0.0-preview.3 </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Terrain Management System - Version 1.0 | Unity Geospatial Streaming | 1.0.0-preview.3 ">
    <meta name="generator" content="docfx 2.58.9.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/statictoc.docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    <meta property="unity:packageTitle" content="Unity Geospatial Streaming | 1.0.0-preview.3">
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
                <div class="back-to-unity-group">
                  <a class="back-to-unity" href="http://docs.unity3d.com/">docs.unity3d.com</a>
                </div>
              </form>
                
                <ul class="nav level1 navbar-nav">
                      <li class="active">
                          <a href="../../manual/index.html" title="Manual">Manual</a>
                      </li>
                      <li class="">
                          <a href="../../api/index.html" title="Scripting API">Scripting API</a>
                      </li>
                      <li class="">
                          <a href="../../changelog/CHANGELOG.html" title="Changelog">Changelog</a>
                      </li>
                      <li class="">
                          <a href="../../license/LICENSE.html" title="License">License</a>
                      </li>
                </ul>    </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list"></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle"></a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div>
              <div class="sidefilter">
                <form class="toc-filter">
                  <span class="glyphicon glyphicon-filter filter-icon"></span>
                  <input type="text" id="toc_filter_input" placeholder="Enter here to filter..." onkeypress="if(event.keyCode==13) {return false;}">
                </form>
              </div>
              <div class="sidetoc">
                <div class="toc" id="toc">
                  
                  <ul class="nav level1">
                    <li class="">
                      <span class="expand-stub"></span>
                      <a href="../index.html" title="GIS Streaming Framework" class="">GIS Streaming Framework</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <span class="expand-stub"></span>
                            <a href="../index.html" title="Getting Started" class="">Getting Started</a>
                              
                              <ul class="nav level3">
                                <li class="">
                                  <a href="../GettingStarted/first-time-setup.html" title="First Time Setup" class="">First Time Setup</a>
                                </li>
                                <li class="">
                                  <a href="../GettingStarted/frequently-asked.html" title="Frequently Asked Questions" class="">Frequently Asked Questions</a>
                                </li>
                                <li class="">
                                  <a href="../GettingStarted/known-limitations.html" title="Known Limitations" class="">Known Limitations</a>
                                </li>
                              </ul>  </li>
                          <li class="">
                            <span class="expand-stub"></span>
                            <a href="../index.html" title="Dataset Formats" class="">Dataset Formats</a>
                              
                              <ul class="nav level3">
                                <li class="">
                                  <a href="../FileFormats/ogc-3d-tiles.html" title="OGC 3D Tiles" class="">OGC 3D Tiles</a>
                                </li>
                                <li class="active">
                                  <a href="../FileFormats/tms.html" title="Terrain Management System" class="active">Terrain Management System</a>
                                </li>
                              </ul>  </li>
                          <li class="">
                            <span class="expand-stub"></span>
                            <a href="../index.html" title="Internal Architecture" class="">Internal Architecture</a>
                              
                              <ul class="nav level3">
                                <li class="">
                                  <a href="../Architecture/universal-decoder.html" title="Universal Decoder" class="">Universal Decoder</a>
                                </li>
                                <li class="">
                                  <a href="../Architecture/material-factory.html" title="Material Factory" class="">Material Factory</a>
                                </li>
                              </ul>  </li>
                        </ul>  </li>
                  </ul>        </div>
              </div>
            </div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="terrain-management-system---version-10">Terrain Management System - Version 1.0</h1>

<p>The Terrain Management System format is a proprietary mesh format designed to be streamed efficiently within the geospatial streaming framework. Its primary objective is 
to provide data that can easily be converted into a UnityEngine.Mesh but formatted 
in such a way that it can easily be procedurally augmented to attenuate or remove
seams between tiles and efficiently sampled such that the application layer can 
easily determine heigh above ground at any point in space.</p>
<h2 id="file-structure">File structure</h2>
<p>The Terrain Management System is designed to be hosted on a static web server or within
a local folder structure. The imagery and elevation, generated at multiple 
resolutions is distributed within a quad tree structure such any area of interest 
can be efficiently fetched at any resolution. The structure of the tree is defined
within a <code>terrain.json</code> file, which informs the streamer of the extent of the 
dataset, its maximum resolution, as well as other parameters which may affect the 
folder structure&#39;s layout.</p>
<p>The folder structure is expected to be as follows:</p>
<pre><code>&lt;Root Folder&gt;
  - terrain.json
  - 0                     // zoom level
    - 0                   // column number
      - 0.utr             // row terrain
      - 0.jpg             // row imagery
      - 1.utr
      - 1.jpg
      - 2.utr
      - 2.jpg
      - ...
    - 1
      - ...
    - 2
      - ...
    - ...
  - 1
    - ...
</code></pre><h3 id="row-and-column-order">Row and Column order</h3>
<p>Rows and columns will be ordered north to south and west to east respectively.
In other words, the north-most row for a given zoom level will have a row number
of zero and the west-most column will have a column number of zero.</p>
<p><img src="../images/FileFormats/TMS-Ordering.png" alt="An example layout of zoom level 2 started with `2 col x 1 row`" title="Example Layout"></p>
<h2 id="terrainjson-specification">Terrain.json Specification</h2>
<p>The <code>terrain.json</code> files allows the streamer to predict the exact folder
structure such that it can directly query the files of interest. It contains
the following properties within a json object:</p>
<h3 id="example-terrainjson-file">Example terrain.json File</h3>
<p>The following is an example <code>terrain.json</code> file which describes a double-head
quad-tree which spans the entire globe, down to zoom-level 13.</p>
<pre><code>{
  &quot;version&quot;:&quot;1.0&quot;

  &quot;extent&quot;:
  {
    &quot;minLat&quot;: -90,
    &quot;maxLat&quot;: 90,
    &quot;minLon&quot;: -180,
    &quot;maxLon&quot;: 180
  },

  &quot;setLimits&quot;:
  {
    &quot;layout&quot;: 277,
    &quot;minLevel&quot;:0,
    &quot;maxLevel&quot;:13,
    &quot;minCol&quot;:0,
    &quot;minRow&quot;:0,
    &quot;maxCol&quot;:1,
    &quot;maxRow&quot;:0
  }

  &quot;content&quot;:
  {
    &quot;terrainFormat&quot;:&quot;utr&quot;,
    &quot;terrainUri&quot;:&quot;.&quot;,
    &quot;imageryFormat&quot;:&quot;jpg&quot;,
    &quot;imageryUri&quot;:&quot;.&quot;
  }
}
</code></pre><h3 id="terrain">Terrain</h3>
<table>
<thead>
<tr>
<th>Property</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>version</td>
<td>string</td>
<td>The major and minor version of the file format. Minor version increments must remain backward compatible.</td>
<td>reqd</td>
</tr>
<tr>
<td>extent</td>
<td>object</td>
<td>The dataset&#39;s extent</td>
<td>reqd</td>
</tr>
<tr>
<td>setLimits</td>
<td>object</td>
<td>Properties pertaining to the file structure</td>
<td>reqd</td>
</tr>
<tr>
<td>content</td>
<td>object</td>
<td>Properties pertaining to the content files</td>
<td>reqd</td>
</tr>
</tbody>
</table>
<h3 id="terrainversion">Terrain.version</h3>
<p>The version of the terrain format being used which follows semantic versioning.</p>
<h3 id="terrainextent">Terrain.extent</h3>
<table>
<thead>
<tr>
<th>Property</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>minLat</td>
<td>double</td>
<td>The minimum latitude of the dataset. This number is expected to be between -90 and 90.</td>
<td>reqd</td>
</tr>
<tr>
<td>maxLat</td>
<td>double</td>
<td>The minimum latitude of the dataset. This number is expected to be between -90 and 90.</td>
<td>reqd</td>
</tr>
<tr>
<td>minLon</td>
<td>double</td>
<td>The minimum longitude of the dataset. This number is expected to be between -180 and 180. If a local dataset were to sit on the anti-meridian, splitting it into two datasets would be required. Few datasets are expected to require this.</td>
<td>reqd</td>
</tr>
<tr>
<td>maxLon</td>
<td>double</td>
<td>The maximum longitude of the dataset. This number is expected to be between -180 and 180. If a local dataset were to sit on the anti-meridian, splitting it into two datasets would be required. Few datasets are expected to require this.</td>
<td>reqd</td>
</tr>
</tbody>
</table>
<h3 id="terrainsetlimits">Terrain.setLimits</h3>
<table>
<thead>
<tr>
<th>Property</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>globalDiv</td>
<td>int</td>
<td>An integer that defines how the tile structure maps to real-world coordinates. See section on <a href="#terrainsetlimitslayout">Terrain.setLimits.Layout</a> for more information.</td>
<td>reqd</td>
</tr>
<tr>
<td>minLevel</td>
<td>int</td>
<td>The minimum zoom level of the dataset. For a full dataset, this should always be zero. However, datasets can start at any zoom level.</td>
<td>0</td>
</tr>
<tr>
<td>maxLevel</td>
<td>int</td>
<td>The maximum zoom level of the dataset, inclusively. In other words, if a value of 10 were to be contained in this property, it would be expected that the folder structure contains zoom-levels from <code>[0, 10]</code>.</td>
<td>reqd</td>
</tr>
<tr>
<td>minCol</td>
<td>int</td>
<td>The minimum column (inclusively) of the dataset within the minimum zoom level.</td>
<td>reqd</td>
</tr>
<tr>
<td>maxCol</td>
<td>int</td>
<td>The maximum column (inclusively) of the dataset within the minimum zoom level.</td>
<td>reqd</td>
</tr>
<tr>
<td>minRow</td>
<td>int</td>
<td>The minimum row (inclusively) of the dataset within the minimum zoom level.</td>
<td>reqd</td>
</tr>
<tr>
<td>maxRow</td>
<td>int</td>
<td>The maximum row (inclusively) of the dataset within the minimum zoom level.</td>
<td>reqd</td>
</tr>
</tbody>
</table>
<h3 id="calculation-of-terrain-extents-for-datasets-with-non-zero-minimum-level">Calculation of terrain extents for datasets with non-zero minimum level</h3>
<p>The value of <code>minLat</code>, <code>maxLat</code>, <code>minLon</code>, and <code>maxLon</code> are relative to the min level of the dataset.</p>
<p>The following is an example which shows the property values of <code>Terrain.extent</code> and <code>Terrain.setLimits</code>, when the dataset with layout 277 starts with a min level &gt; 0:</p>
<p><img src="../images/FileFormats/TerrainExtentExample.PNG" alt="An example layout of zoom level 1 started with `2 col x 1 row`" title="Terrain extent for a dataset with min level = 1"></p>
<pre><code>&quot;extent&quot;:
{
  &quot;minLat&quot;: 0,
  &quot;maxLat&quot;: 90,
  &quot;minLon&quot;: -90,
  &quot;maxLon&quot;: 90
},

&quot;setLimits&quot;:
{
  &quot;layout&quot;: 277,
  &quot;minLevel&quot;:1,
  &quot;maxLevel&quot;:2,
  &quot;minCol&quot;:1,
  &quot;minRow&quot;:1,
  &quot;maxCol&quot;:2,
  &quot;maxRow&quot;:1
}
</code></pre><h3 id="terraincontent">Terrain.content</h3>
<table>
<thead>
<tr>
<th>Property</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>terrainFormat</td>
<td>string</td>
<td>See <a href="#terraincontentterrainformat">Terrain.content.terrainFormat</a> for more information</td>
<td>&quot;none&quot;</td>
</tr>
<tr>
<td>terrainUri</td>
<td>string</td>
<td>Uri to the folder containing the terrain data</td>
<td>&quot;.&quot;</td>
</tr>
<tr>
<td>imageryFormat</td>
<td>string</td>
<td>See <a href="#terraincontentimageryformat">Terrain.content.imageryFormat</a> for more information</td>
<td>&quot;none&quot;</td>
</tr>
<tr>
<td>imageryUri</td>
<td>string</td>
<td>Uri to the folder containing the imagery data</td>
<td>&quot;.&quot;</td>
</tr>
</tbody>
</table>
<h3 id="terrainsetlimitslayout">Terrain.setLimits.Layout</h3>
<p>This 2D distribution of tiles can be laid out multiple ways to represent the 
globe. The global division defines how the 2D distribution maps to a 3D surface
such as the earth. Currently, only one division mode is specified but many more
could be specified to represent bodies other than the earth as well as accommodate
S2-like layouts, for example.</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>Z0 Dims (WxH)</th>
<th>Subdivision Proportions</th>
<th>Elevation Reference</th>
</tr>
</thead>
<tbody>
<tr>
<td>277</td>
<td>2x1</td>
<td>Equal and uniform geodetic subdivision according to EPSG4326. For example, a tile measuring 45deg x 45deg would break into four tiles measuring 22.5deg x 22.5deg, regardless of latitude.</td>
<td>WGS84</td>
</tr>
</tbody>
</table>
<h3 id="terraincontentterrainformat">Terrain.content.terrainFormat</h3>
<p>The format of the terrain files contained within the dataset. This can take
one of the following values:</p>
<ul>
<li>none: Indicates that no elevation data is contained within the dataset.</li>
<li>utr: Indicates that the elevation data is in <code>utr</code> format, as described in the
present document.</li>
</ul>
<p>See the section on <a href="#terrain-format">Terrain Format</a> for more information about
the utr files.</p>
<h3 id="terraincontentimageryformat">Terrain.content.imageryFormat</h3>
<p>The format of the imagery files contained within the dataset. This can take
the following values:</p>
<ul>
<li>none: Indicates that no imagery is provided in the dataset.</li>
<li>jpg: Indicates that jpg files have been provided in the dataset</li>
<li>png: Indicates that png files have been provided in the dataset.</li>
</ul>
<p>See the section on <a href="#imagery-format">Imagery Format</a> for more information about 
the expected imagery formats.</p>
<h2 id="terrain-format">Terrain Format</h2>
<p>A <code>.utr</code> file is a binary file that contains mesh information about the terrain.
Each file is inherently self-sufficient and can be individually turned into a
mesh. The layout of the binary file follows the following C# data struct:</p>
<pre><code>[StructLayout(LayoutKind.Sequential)]
public struct Header
{
  public fixed byte[4] magic
  public unsigned int fileByteSize;
  public int type;

  public unsigned short majorVersion;
  public unsigned short minorVersion;
}


public struct TileData
{
  public unsigned int layout;
  public double minLon;
  public double maxLon;
  public double minLat;
  public double maxLat;
  public double minElevation;
  public double maxElevation;
  public float geometricError;

  public unsigned short vertexBufferOffset;
  public unsigned short vertexBufferCount;
  public unsigned short trianglesOffset;
  public unsigned short trianglesCount;

  public unsigned short northEdgeStart;
  public unsigned short northEdgeCount;
  public unsigned short northEdgeExtra;
  public unsigned short eastEdgeStart;
  public unsigned short eastEdgeCount;
  public unsigned short eastEdgeExtra;
  public unsigned short southEdgeStart;
  public unsigned short southEdgeCount;
  public unsigned short southEdgeExtra;
  public unsigned short westEdgeStart;
  public unsigned short westEdgeCount;
  public unsigned short westEdgeExtra;
}

[StructLayout(LayoutKind.Sequential)]
public struct Vertex
{
  public unsigned short u;
  public unsigned short v;
  public unsigned short z;
  public short nu;
  public short nv;
}

[StructLayout(LayoutKind.Sequential)]
public struct Triangle
{
  public short a;
  public short b;
  public short c;
}
</code></pre><p>The header must correspond to the first bytes contained within the file. If the
tile is a non-empty tile, the TileData must then immediately follow. However, the 
byte structure following these two sections can be arranged and padded arbitrarily, 
provided that the start address of the buffers have been correctly attributed
within the header.</p>
<p><img src="../images/FileFormats/TMS-UTRLayout.png" alt="Example File Layout"></p>
<h3 id="header">Header</h3>
<p>The header is comprised of the following properties:</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>magic</td>
<td>4 unique bytes to identify the file. These are always <code>utrm</code></td>
</tr>
<tr>
<td>fileByteSize</td>
<td>The total size of the file, in bytes.</td>
</tr>
<tr>
<td>type</td>
<td><p>The type of the given terrain data</p><ul><li>0 = Empty without children</li><li>1 = Empty with children</li><li>25 = TileData without children</li><li>26 = TileData with children</li></ul></td>
</tr>
<tr>
<td>majorVersion</td>
<td>The major version of this tile. An increment in the major version is expected to require a new version of the decoder</td>
</tr>
<tr>
<td>minorVersion</td>
<td>The minor version of this tile. An increment in the minor version is expected to continue working with previous decoders and only provides extra information.</td>
</tr>
</tbody>
</table>
<h3 id="tiledata">TileData</h3>
<p>If the terrain is of tile type, it is expected that a tiledata block follows
immediately after then header. The <code>tileData</code> block has the following properties:</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>layout</td>
<td>Same as <a href="#terrainsetlimitslayout">Terrain.setLimits.layout</a></td>
</tr>
<tr>
<td>minLon</td>
<td>The minimum longitude of the tile, in degrees</td>
</tr>
<tr>
<td>maxLon</td>
<td>The maximum longitude of the tile, in degrees</td>
</tr>
<tr>
<td>minLat</td>
<td>The minimum latitude of the tile, in degrees</td>
</tr>
<tr>
<td>maxLat</td>
<td>The maximum latitude of the tile, in degrees</td>
</tr>
<tr>
<td>minElevation</td>
<td>The minimum elevation of the tile, relative to the reference specified in the <code>terrain.json</code> file.</td>
</tr>
<tr>
<td>maxElevation</td>
<td>The maximum elevation of the tile, relative to the ellipsoid specified in the <code>terrain.json</code> file.</td>
</tr>
<tr>
<td>vertexBufferStart</td>
<td>The start of the vertex buffer relative to the start of the file, in bytes.</td>
</tr>
<tr>
<td>vertexBufferCount</td>
<td>The number of vertices represented within the vertex buffer.</td>
</tr>
<tr>
<td>trianglesStart</td>
<td>The start of the index buffer relative to the start of the file, in bytes.</td>
</tr>
<tr>
<td>trianglesCount</td>
<td>The number of triangles represented in the index buffer.</td>
</tr>
<tr>
<td>northEdgeStart</td>
<td>The starting index of the vertices which compose the north edge of the tile.</td>
</tr>
<tr>
<td>northEdgeCount</td>
<td>The number of vertices which compose the north edge of the tile.</td>
</tr>
<tr>
<td>northEdgeExtra</td>
<td>The last vertex of the north edge. Can be set to 65535 if unused.</td>
</tr>
<tr>
<td>eastEdgeStart</td>
<td>The starting index of the vertices which compose the east edge of the tile.</td>
</tr>
<tr>
<td>eastEdgeCount</td>
<td>The number of vertices which compose the east edge of the tile.</td>
</tr>
<tr>
<td>eastEdgeExtra</td>
<td>The last vertex of the east edge. Can be set to 65535 if unused.</td>
</tr>
<tr>
<td>southEdgeStart</td>
<td>The starting index of the vertices which compose the south edge of the tile.</td>
</tr>
<tr>
<td>southEdgeCount</td>
<td>The number of vertices which compose the south edge of the tile.</td>
</tr>
<tr>
<td>southEdgeExtra</td>
<td>The last vertex of the south edge. Can be set to 65535 if unused.</td>
</tr>
<tr>
<td>westEdgeStart</td>
<td>The starting index of the vertices which compose the west edge of the tile.</td>
</tr>
<tr>
<td>westEdgeCount</td>
<td>The number of vertices which compose the west edge of the tile.</td>
</tr>
<tr>
<td>westEdgeExtra</td>
<td>The last vertex of the west edge. Can be set to 65535 if unused.</td>
</tr>
</tbody>
</table>
<p>Note 1: Edge data is expected to be laid out such that they are ordered clock-wise
when viewed from above. </p>
<p>Note 2: Edge data is expected to include both corners.</p>
<p>Note 3: The extra vertex can be used to indicate the last vertex of the edge, 
should the last vertex need to be discontinuously laid out in the vertex buffer. 
If possible, prefer a continuous vertex layout and set the extra to 65535. It is
normal and expected that at least one edge requires the use of the extra. </p>
<h3 id="vertex-data">Vertex Data</h3>
<p>The vertex data is comprised of the following properties:</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>u</td>
<td>The longitude of the vertex relative to <code>minLon</code> and <code>maxLon</code>. A value of <code>0</code> will make the longitude of this vertex correspond exactly to <code>minLon</code> and a value of <code>2^16-1</code> would correspond exactly to <code>maxLon</code>. Vertices on the western-most edge of the tile are expected to have values of <code>0</code> and vertices on the eastern-most edge of the tile are expected to have values of <code>2^16-1</code>.</td>
</tr>
<tr>
<td>v</td>
<td>The latitude of the vertex relative to <code>minLat</code> and <code>maxLat</code>. A value of <code>0</code> will make the latitude of this vertex correspond exactly to <code>minLat</code> and a value of <code>2^16-1</code> would correspond exactly to <code>maxLat</code>. Vertices on the northern-most edge of the tile are expected to have values of <code>0</code> and vertices on the southern-most edge of the tile are expected to have values of <code>2^16-1</code>.</td>
</tr>
<tr>
<td>z</td>
<td>The elevation of the vertex relative to <code>maxElevation</code> and <code>minElevation</code>. A value of <code>0</code> will make the elevation of this vertex correspond exactly to <code>minElevation</code> and a value of <code>2^16-1</code> would correspond exactly to <code>maxElevation</code>. It is normal and expected normal for values of <code>0</code> and <code>2^16-1</code> to appear in this field.</td>
</tr>
<tr>
<td>n<sub>u</sub> &amp; n<sub>v</sub></td>
<td>Two of the tree normal values of any given vertex. See section on <a href="#calculating-normals">Calculating Normals</a> for more information.</td>
</tr>
</tbody>
</table>
<h3 id="index-data">Index Data</h3>
<p>The index data is used to form triangles with the vertices specified in the
vertex buffer. Each triangle is comprised of 3 vertices arranged in clock-wise
winding order. The integers used represent the index of the vertex within the 
buffer. In other words, a value of 0 would represent the very first vertex within
the vertex buffer.</p>
<h3 id="calculating-normals">Calculating Normals</h3>
<p>Normals provided within a tile need to be converted over to normals that can 
be represented on the GPU. This is how to achieve this conversion:</p>
<p>Assuming x, y and z which follow the ECEF standard and a set of reference 
vectors r<sub>u</sub>, r<sub>v</sub> and r<sub>w</sub> which form a orthonormal 
set where r<sub>w</sub> represents an up vector relative to the elevation 
reference, r<sub>u</sub> represents a vector pointing due-east and r<sub>v</sub> represents a vector pointing due-north. The normal vector n would be derived 
using the following expressions:</p>
<p>m<sub>u</sub> = 1/32768 * n<sub>u</sub></p>
<p>m<sub>v</sub> = 1/32768 * n<sub>v</sub></p>
<p>m<sub>w</sub> = sqrt(1 - m<sub>u</sub><sup>2</sup> - m<sub>v</sub><sup>2</sup>)</p>
<p>n = m<sub>u</sub> * r<sub>u</sub> + m<sub>v</sub> * r<sub>v</sub> + m<sub>w</sub> * r<sub>w</sub></p>
<p>Conversely, for each vertex in a mesh defined in ECEF, the same r<sub>u</sub> and
r<sub>v</sub> described above can be used to compute n<sub>u</sub> and n<sub>v</sub>
from normalized vector n defined within the ECEF coordinate system.</p>
<p>n<sub>u</sub> = 32768 * dot(n, r<sub>u</sub>)</p>
<p>n<sub>v</sub> = 32768 * dot(n, r<sub>v</sub>)</p>
<h2 id="imagery-format">Imagery Format</h2>
<p>The imagery of each cell is expected to respect the following constraints:</p>
<ul>
<li>Imagery is expected to be either in jpg or png format.</li>
<li>The format and resolution of all images at all zoom levels is identical.</li>
<li>The resolutions of the images are equal in both dimensions.</li>
<li>The resolution of the imagery is a power of 2.</li>
<li>The color space of the imagery is encoded sRGB.</li>
<li>The images are oriented such that north is up and east is right.</li>
</ul>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
